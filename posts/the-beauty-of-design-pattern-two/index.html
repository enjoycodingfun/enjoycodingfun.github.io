<!DOCTYPE html>
<html>
<head>
    

    
<!-- Tencent Speed -->
<script>var _speedMark = new Date()</script>
<!-- End Tencent Speed -->
<!-- Tencent Analysis -->
<script async src="//tajs.qq.com/stats?sId=66530752"></script>
<!-- End Tencent Analysis -->


    


<!-- Baidu Push -->
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<!-- End Baidu Push -->


    <meta charset="utf-8">
    
    
    
    <link rel="canonical" href="https://www.enjoyican.com//posts/the-beauty-of-design-pattern-two/">
    
    
    <title>设计模式之美学习笔记二 | Running | Better Late Than Never</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="note">
    <meta name="description" content="这部分总结了23种设计模式的定义，适用场景，部分设计模式写了小demo来演示。总体来说设计模式一定要注意他的适用场景和实现方式这两点，只关注实现方式，就会觉得好几种设计模式类图差不多，但实际上这几种的应用场景完全不同，如果只关注适用场景，具体写代码还是不会套用，那也是纸上谈兵，总之设计模式常看常新，每次都有不同的体会。有问题可以在本博客下留言或者CSDN上留言。">
<meta property="og:type" content="article">
<meta property="og:title" content="设计模式之美学习笔记二">
<meta property="og:url" content="https://www.enjoyican.com/posts/the-beauty-of-design-pattern-two/index.html">
<meta property="og:site_name" content="Running">
<meta property="og:description" content="这部分总结了23种设计模式的定义，适用场景，部分设计模式写了小demo来演示。总体来说设计模式一定要注意他的适用场景和实现方式这两点，只关注实现方式，就会觉得好几种设计模式类图差不多，但实际上这几种的应用场景完全不同，如果只关注适用场景，具体写代码还是不会套用，那也是纸上谈兵，总之设计模式常看常新，每次都有不同的体会。有问题可以在本博客下留言或者CSDN上留言。">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2020-07-28T11:34:30.000Z">
<meta property="article:modified_time" content="2020-07-28T11:34:30.000Z">
<meta property="article:author" content="enjoycodingfun">
<meta property="article:tag" content="note">
<meta name="twitter:card" content="summary">
    
        <link rel="alternate" type="application/atom+xml" title="Running" href="/atom.xml">
    
    <link rel="shortcut icon" href="/img/timg.jpg">
    <link rel="stylesheet" href="/css/style.css?v=1.7.2">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

<meta name="generator" content="Hexo 4.2.0"></head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/head.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">enjoycodingfun</h5>
          <a href="mailto:17364562230@163.com" title="17364562230@163.com" class="mail">17364562230@163.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                归档
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                标签
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                分类
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/enjoycodingfun" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://blog.csdn.net/u010408502" target="_blank" rel="noopener"  >
                <i class="icon icon-lg icon-link"></i>
                CSDN
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/img/mywechat.png"  >
                <i class="icon icon-lg icon-wechat"></i>
                微信
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">设计模式之美学习笔记二</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">设计模式之美学习笔记二</h1>
        <h5 class="subtitle">
            
                <time datetime="2020-07-28T11:34:30.000Z" itemprop="datePublished" class="page-time">
  2020-07-28
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/">读书笔记</a></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>大纲</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#构建型设计模式"><span class="post-toc-text">构建型设计模式</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#单例模式"><span class="post-toc-text">单例模式</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#饿汉式："><span class="post-toc-text">饿汉式：</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#懒汉式"><span class="post-toc-text">懒汉式</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#双重检测（double-check）模式"><span class="post-toc-text">双重检测（double check）模式</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#静态内部类"><span class="post-toc-text">静态内部类</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#枚举"><span class="post-toc-text">枚举</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#单例模式存在的问题"><span class="post-toc-text">单例模式存在的问题</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#如何替代单例模式"><span class="post-toc-text">如何替代单例模式</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#工厂模式"><span class="post-toc-text">工厂模式</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#建造者模式"><span class="post-toc-text">建造者模式</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#原型模式"><span class="post-toc-text">原型模式</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#小结"><span class="post-toc-text">小结</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#结构型设计模式"><span class="post-toc-text">结构型设计模式</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#代理模式（Proxy-Design-Pattern）"><span class="post-toc-text">代理模式（Proxy Design Pattern）</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#代理模式的应用场景："><span class="post-toc-text">代理模式的应用场景：</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#桥接模式（Bridge-Design-Pattern）"><span class="post-toc-text">桥接模式（Bridge Design Pattern）</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#装饰器模式"><span class="post-toc-text">装饰器模式</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#适配器模式（Adapter-Design-Pattern）"><span class="post-toc-text">适配器模式（Adapter Design Pattern）</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#代理、桥接、装饰器、适配器四种设计模式的区别"><span class="post-toc-text">代理、桥接、装饰器、适配器四种设计模式的区别</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#门面模式（Facade-Design-Pattern）"><span class="post-toc-text">门面模式（Facade Design Pattern）</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#组合模式（Composite-Design-Pattern）"><span class="post-toc-text">组合模式（Composite Design Pattern）</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#享元模式（Flyweight-Design-Pattern）"><span class="post-toc-text">享元模式（Flyweight Design Pattern）</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#行为型设计模式"><span class="post-toc-text">行为型设计模式</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#观察者模式（Observer-Design-Pattern）"><span class="post-toc-text">观察者模式（Observer Design Pattern）</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#模板模式（Template-Method-Design-Pattern）"><span class="post-toc-text">模板模式（Template Method Design Pattern）</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#模板方法模式的作用"><span class="post-toc-text">模板方法模式的作用</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#策略模式（Strategy-Design-Pattern）"><span class="post-toc-text">策略模式（Strategy Design Pattern）</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#责任链模式（Chain-of-Responsibility-Design-Pattern）"><span class="post-toc-text">责任链模式（Chain of Responsibility Design Pattern）</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#状态模式"><span class="post-toc-text">状态模式</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#备忘录模式（Memento-Design-Pattern）"><span class="post-toc-text">备忘录模式（Memento Design Pattern）</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#迭代器模式（Iterator-Design-Pattern）"><span class="post-toc-text">迭代器模式（Iterator Design Pattern）</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#访问者模式（Visitor-Design-Pattern）"><span class="post-toc-text">访问者模式（Visitor Design Pattern）</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#命令模式（Command-Design-Pattern）"><span class="post-toc-text">命令模式（Command Design Pattern）</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#解释器模式（Interpreter-Design-Pattern）"><span class="post-toc-text">解释器模式（Interpreter Design Pattern）</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#中介模式（Mediator-Design-Pattern）"><span class="post-toc-text">中介模式（Mediator Design Pattern）</span></a></li></ol></li></ol>
        </nav>
    </aside>


<article id="post-the-beauty-of-design-pattern-two"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">设计模式之美学习笔记二</h1>
        <div class="post-meta">
            <time class="post-time" title="2020-07-28 19:34:30" datetime="2020-07-28T11:34:30.000Z"  itemprop="datePublished">2020-07-28</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/">读书笔记</a></li></ul>



            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <p>这部分总结了23种设计模式的定义，适用场景，部分设计模式写了小demo来演示。总体来说设计模式一定要注意他的适用场景和实现方式这两点，只关注实现方式，就会觉得好几种设计模式类图差不多，但实际上这几种的应用场景完全不同，如果只关注适用场景，具体写代码还是不会套用，那也是纸上谈兵，总之设计模式常看常新，每次都有不同的体会。有问题可以在本博客下留言或者<a href="https://blog.csdn.net/u010408502/article/details/107677272" target="_blank" rel="noopener">CSDN</a>上留言。</p>
<a id="more"></a>

<h1 id="构建型设计模式"><a href="#构建型设计模式" class="headerlink" title="构建型设计模式"></a>构建型设计模式</h1><h2 id="单例模式"><a href="#单例模式" class="headerlink" title="单例模式"></a>单例模式</h2><p>如何实现一个单例：</p>
<ul>
<li>构造函数需要是private访问权限，避免外部直接new对象</li>
<li>考虑对象创建时的线程安全问题</li>
<li>考虑是否支持懒加载</li>
<li>考虑getInstance()性能是否高（是否加锁） </li>
</ul>
<h3 id="饿汉式："><a href="#饿汉式：" class="headerlink" title="饿汉式："></a>饿汉式：</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span></span>&#123; </span><br><span class="line">     <span class="keyword">private</span> <span class="keyword">static</span> Singleton instance = <span class="keyword">new</span> Singleton(); </span><br><span class="line">     <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span></span>&#123;&#125; </span><br><span class="line">     <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span></span>&#123;  </span><br><span class="line">          <span class="keyword">return</span> instance;  </span><br><span class="line">      &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>优点：线程 安全，调用效率高</p>
<p>缺点：一上来就实例化了单例，如果该单例从头到尾都没有用到，或者初始化的耗时较长，是一种资源的浪费，不支持懒加载</p>
<p>不过专栏作者的意见是如果确实初始化耗时较长，反而不如通过饿汉式在项目启动初期就加载好，以免在后面实际使用的时候才加载（懒加载）造成性能损耗，或者用户体验下降</p>
<h3 id="懒汉式"><a href="#懒汉式" class="headerlink" title="懒汉式"></a>懒汉式</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;</span><br><span class="line">     </span><br><span class="line">    <span class="comment">//类初始化时，不初始化这个对象(延时加载，真正用的时候再创建)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton instance;</span><br><span class="line">     </span><br><span class="line">    <span class="comment">//构造器私有化</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">     </span><br><span class="line">    <span class="comment">//方法同步，调用效率低</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> Singleton <span class="title">getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(instance==<span class="keyword">null</span>)&#123;</span><br><span class="line">            instance=<span class="keyword">new</span> Singleton();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>优点：线程安全，支持懒加载（即真正使用的时候再去加载）</p>
<p>缺点：获取单例的方法加锁，性能不高</p>
<h3 id="双重检测（double-check）模式"><a href="#双重检测（double-check）模式" class="headerlink" title="双重检测（double check）模式"></a>双重检测（double check）模式</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">volatile</span> <span class="keyword">static</span> Singleton singleton;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">newInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (singleton == <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">synchronized</span> (Singleton<span class="class">.<span class="keyword">class</span>) </span>&#123;</span><br><span class="line">                    <span class="keyword">if</span> (singleton == <span class="keyword">null</span>) &#123;</span><br><span class="line">                        singleton = <span class="keyword">new</span> Singleton();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> singleton;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>优点：即支持懒加载模式，又避免了懒汉式每次调用均加锁造成的性能损耗（只要第一次创建成功后，后续再次调用就不会进入同步方法）。</p>
<p>缺点：注意singleton成员变量前一定要加volatile关键字，防止指令重排。这么做的目的是避免因为指令重排导致实例被new出来之后（实例化）赋值给singleton变量后还没来得及初始化，就被另外一个线程使用了。<strong>目前高版本的java已经在JDK内部解决了这个问题（通过将new对象和初始化操作设计为原子性操作，即可避免指令重排带来的问题）</strong></p>
<h3 id="静态内部类"><a href="#静态内部类" class="headerlink" title="静态内部类"></a>静态内部类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonHolder</span></span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Singleton instance=<span class="keyword">new</span> Singleton();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> SingletonHolder.instance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>优点：线程安全，效率高，支持懒加载。由于SingletonHolder是一个静态内部类，当外部类Singleton被加载的时候，并不会创建SingletonHolder实例对象，只有当调用getInstance()方法时，SingletonHolder才会被加载，这个时候才创建instance实例，实例的唯一性，创建过程的线程安全性，都由JVM保证</p>
<h3 id="枚举"><a href="#枚举" class="headerlink" title="枚举"></a>枚举</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> Singleton &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//枚举元素本身就是单例</span></span><br><span class="line">    INSTANCE;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//添加自己需要的操作</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">singletonOperation</span><span class="params">()</span></span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>优点：通过枚举本身的特点（枚举实例本身就是单例的）保证了创建实例的线程安全性和实例的唯一性。线程安全，调用效率高，不能延时加载，可以天然的防止反射和反序列化调用</p>
<h3 id="单例模式存在的问题"><a href="#单例模式存在的问题" class="headerlink" title="单例模式存在的问题"></a>单例模式存在的问题</h3><p>大部分情况下，我们使用单例来表示一些全局唯一类，比如配置信息类，连接池类，ID生成器类。</p>
<p><strong>单例对OOP特性的支持不友好</strong></p>
<p>由于单例的使用方式基于实现类而非基于接口，将来想要更换一种生成单例的方式，需要变更代码的各个地方，此外单例对继承，多态的支持也不好（不是不能继承，只是这样做比较怪异）</p>
<p><strong>单例会隐藏类之间的依赖关系</strong></p>
<p>由于单例的调用是直接调用其对外提供的公共方法，内部去生成实例对象，单例类不需要显式创建，不需要依赖参数传递，在函数中直接调用就可以了，如果代码比较复杂，这种调用关系就会非常隐蔽</p>
<p><strong>单例对代码的拓展性不友好</strong></p>
<p>由于单例类只能有一个对象实例，如果将来由于需求变更需要支持多实例，就需要改动较多代码。</p>
<p><strong>单例对代码的可测试性不友好</strong></p>
<p><strong>单例不支持有参数的构造函数</strong></p>
<p>参数的传递需要放在getInstance（）中</p>
<h3 id="如何替代单例模式"><a href="#如何替代单例模式" class="headerlink" title="如何替代单例模式"></a>如何替代单例模式</h3><p>为了保证全局唯一，除了使用单例，还可以使用静态方法来实现。但是他比单例更加不灵活，比如无法支持懒加载。实际上类对象的全局唯一性可以通过多种方式保证，除了单例模式，还有工厂模式，IOC容器保证 ，或者程序员代码中保证。</p>
<h2 id="工厂模式"><a href="#工厂模式" class="headerlink" title="工厂模式"></a>工厂模式</h2><p>一般情况下工厂模式被分为简单工厂（静态工厂方法模式）、工厂方法和抽象工厂三类。简单工厂和工厂方法原理简单，项目中常用，抽象工厂原理稍微复杂，在项目中不经常用。</p>
<p>工厂方法相比简单工厂方法，需要更多的类去实现工厂方法接口类，当对象的创建逻辑比较复杂，不只是简单new一下的时候推荐使用工厂模式，将复杂的创建逻辑拆分到各个工厂类中，让每个工厂类不至于过于复杂。</p>
<p>总结下就是简单工厂将对象创建的不同分支用if、else写在一个工厂类中，工厂方法是将这些分支拆分成不同的工厂类。</p>
<p>当创建逻辑比较复杂，是一个大工程的时候，就需要考虑使用工厂模式，封装对象的创建，将对象的创建与使用分离开来。</p>
<p>工厂模式的作用无外乎下面四个，也是我们判断要不要使用工厂模式的标准：</p>
<ul>
<li>封装变化：创建逻辑有可能发生变化，封装成工厂类之后，创建逻辑的变更对调用者透明</li>
<li>代码复用：创建代码抽离到独立的工厂类之后可以复用</li>
<li>隔离复杂性：封装复杂的创建逻辑，调用者无需了解如何创建对象</li>
<li>控制复杂度：将创建代码抽离出来，让原本的函数或类职责更单一，代码更简洁</li>
</ul>
<p>以DI容器讲解工厂模式：</p>
<p>DI容器的核心功能一般有三点：配置解析，对象创建和对象生命周期管理，详情可以看spring源码解析</p>
<p>下面是简单工厂模式和工厂模式的示例代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//手机类</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IMobile</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">call</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Huawei</span> <span class="keyword">implements</span> <span class="title">IMobile</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"我是华为手机"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Xiaomi</span> <span class="keyword">implements</span> <span class="title">IMobile</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"我是小米手机"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Oppo</span> <span class="keyword">implements</span> <span class="title">IMobile</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"我是oppo手机"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//简单工厂类</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 简单工厂模式</span></span><br><span class="line"><span class="comment"> * 特点，各种类型的类创建并不复杂，把类的创建写在一个工厂类中，</span></span><br><span class="line"><span class="comment"> * 可以通过if，else，或者map获取具体的类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SimpleFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IMobile <span class="title">createMobile</span><span class="params">(String brand)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (brand == <span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (brand.equalsIgnoreCase(<span class="string">"huawei"</span>))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> Huawei();</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span> (brand.equalsIgnoreCase(<span class="string">"xiaomi"</span>))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> Xiaomi();</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span> (brand.equalsIgnoreCase(<span class="string">"oppo"</span>))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> Oppo();</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        IMobile mobile = SimpleFactory.createMobile(<span class="string">"huawei"</span>);</span><br><span class="line">        <span class="keyword">if</span> (mobile != <span class="keyword">null</span>) &#123;</span><br><span class="line">            mobile.call();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//工厂方法模式</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IMobileFactory</span> </span>&#123;</span><br><span class="line">    <span class="function">IMobile <span class="title">getMobile</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HuaweiFcatory</span> <span class="keyword">implements</span> <span class="title">IMobileFactory</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> IMobile <span class="title">getMobile</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//经过一系列复杂的判断，前置条件校验，准备</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Huawei();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">XiaomiFactory</span> <span class="keyword">implements</span> <span class="title">IMobileFactory</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> IMobile <span class="title">getMobile</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//经过一系列复杂的判断，前置条件校验，准备</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Xiaomi();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OppoFactory</span> <span class="keyword">implements</span> <span class="title">IMobileFactory</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> IMobile <span class="title">getMobile</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//经过一系列复杂的判断，前置条件校验，准备</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Oppo();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//实际中可以根据传入的参数获取具体的工厂类</span></span><br><span class="line">        IMobileFactory factory = <span class="keyword">new</span> HuaweiFcatory();</span><br><span class="line">        <span class="comment">//创建手机的逻辑比较复杂，拆分为各种工厂类（示例中比较简单，忽略）</span></span><br><span class="line">        IMobile mobile = factory.getMobile();</span><br><span class="line">        mobile.call();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="建造者模式"><a href="#建造者模式" class="headerlink" title="建造者模式"></a>建造者模式</h2><p>建造者模式与工厂模式的不同</p>
<p>工厂模式是用来创建不同但是相关类型的对象（继承同一父类或者接口的一组子类），由给定的参数来决定创建哪种对象。建造者模式是用来创建一种类型的复杂对象，通过设置不同的参数，”定制化”地创建不同的对象。</p>
<p>建造者模式的使用场景：</p>
<ul>
<li>当类的构造函数必填属性很多，通过set设置，没有办法校验必填属性</li>
<li>如果类的属性之间具有一定的依赖关系，构造函数配合set方式，无法进行依赖关系和约束条件校验</li>
<li>需要创建不可变对象，不能暴露set方法</li>
</ul>
<p>实现方式：把构造函数定义为private，定义public static class Builder内部类，通过Builer类的set方法设置属性，调用build方法创建对象。下面是一个简单示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">*假设数据库连接池参数配置有很多，现在我们通过建造者模式来完成创建DataBaseConnectPoolConfig</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DataBaseConnectPoolConfig</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * # 数据库的连接地址。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String url;</span><br><span class="line">    <span class="keyword">private</span> String userName;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 初始化时建立的物理连接数。初始化发生在显式调用init方法，或者第一次getConnection时.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer initialSize;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 连接池最大物理连接数量。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer maxActive;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DataBaseConnectPoolConfig</span><span class="params">(Builder builder)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.url = builder.url;</span><br><span class="line">        <span class="keyword">this</span>.userName = builder.userName;</span><br><span class="line">        <span class="keyword">this</span>.password = builder.password;</span><br><span class="line">        <span class="keyword">this</span>.initialSize = builder.initialSize;</span><br><span class="line">        <span class="keyword">this</span>.maxActive = builder.maxActive;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 这里的builder设置为一个静态内部类，也可以单独拿出去作为一个类</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Data</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Builder</span></span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String URLSTRING = <span class="string">"myUrl"</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String USERNAME = <span class="string">"username"</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String PASSWORD = <span class="string">"password"</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> String url = URLSTRING;</span><br><span class="line">        <span class="keyword">private</span> String userName = USERNAME;</span><br><span class="line">        <span class="keyword">private</span> String password = PASSWORD;</span><br><span class="line">        <span class="keyword">private</span> Integer initialSize;</span><br><span class="line">        <span class="keyword">private</span> Integer maxActive;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> DataBaseConnectPoolConfig <span class="title">build</span><span class="params">()</span></span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (initialSize == <span class="number">5</span>)&#123;</span><br><span class="line">                System.out.println(<span class="string">"初始化的连接数为5"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//经过一系列的判断等等操作（对set方法之后的数据校验），返回创建好的连接池配置对象</span></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> DataBaseConnectPoolConfig(<span class="keyword">this</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Builder <span class="title">setUrl</span><span class="params">(String url)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.url = url;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Builder <span class="title">setUserName</span><span class="params">(String userName)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.userName = userName;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Builder <span class="title">setPassword</span><span class="params">(String password)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.password = password;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Builder <span class="title">setInitialSize</span><span class="params">(Integer initialSize)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.initialSize = initialSize;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Builder <span class="title">setMaxActive</span><span class="params">(Integer maxActive)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.maxActive = maxActive;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//模拟客户端通过建造者模式创建连接池配置对象</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        DataBaseConnectPoolConfig config = <span class="keyword">new</span> Builder().setUrl(<span class="string">"http://abc"</span>)</span><br><span class="line">                .setUserName(<span class="string">"zhangsan"</span>).setPassword(<span class="string">"abc"</span>).setInitialSize(<span class="number">5</span>)</span><br><span class="line">                .setMaxActive(<span class="number">5</span>).build();</span><br><span class="line">        System.out.println(config.toString());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="原型模式"><a href="#原型模式" class="headerlink" title="原型模式"></a>原型模式</h2><p><strong>什么是原型模式</strong></p>
<p>如果对象的创建成本比较大，而同一个类的不同对象之间差别不大（大部分字段相同），在这种情况下，我们可以利用对已有对象（原型）进行复制（拷贝）的方式来创建新的对象，以达到节省创建时间的目的。这种基于原型来创建对象的方式叫做原型模式</p>
<p><strong>原型模式的两种实现方式</strong></p>
<p>深拷贝和浅拷贝。浅拷贝只复制对象基本数据类型数据和引用对象的内存地址，不会递归的复制引用对象，以及引用对象的引用对象，而深拷贝得到的是一份完全独立的对象，所以深拷贝比浅拷贝更耗时间。</p>
<p>如果要拷贝的对象是不可变对象，浅拷贝共享不可变对象是没有问题的，但是对于可变对象来说，浅拷贝得到的对象和原始对象会共享部分数据，就有可能会出现数据被修改的风险。</p>
<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>单例模式用来创建全局唯一的对象。工厂模式用来创建不同但是相关类型的对象（继承同一父类或者接口的一组子类），由给定的参数来决定创建哪种类型的对象。建造者模式是用来创建复杂对象，可以通过设置不同的可选参数，定制化的创建不同的对象。原型模式针对创建成本比较大的对象，利用对已有对象进行复制的方式进行创建，以节省创建时间。</p>
<h1 id="结构型设计模式"><a href="#结构型设计模式" class="headerlink" title="结构型设计模式"></a>结构型设计模式</h1><p>结构型模式包括：代理模式，桥接模式，装饰器模式，适配器模式，门面模式，组合模式，享元模式</p>
<h2 id="代理模式（Proxy-Design-Pattern）"><a href="#代理模式（Proxy-Design-Pattern）" class="headerlink" title="代理模式（Proxy Design Pattern）"></a>代理模式（Proxy Design Pattern）</h2><h3 id="代理模式的应用场景："><a href="#代理模式的应用场景：" class="headerlink" title="代理模式的应用场景："></a>代理模式的应用场景：</h3><p><strong>业务系统的非功能性需求开发</strong></p>
<p>比如：监控，统计，鉴权，限流，事务，幂等，日志等（AOP就是基于动态代理）</p>
<p><strong>在RPC/缓存中的使用</strong></p>
<p>RPC框架也可以看做一种代理模式</p>
<h2 id="桥接模式（Bridge-Design-Pattern）"><a href="#桥接模式（Bridge-Design-Pattern）" class="headerlink" title="桥接模式（Bridge Design Pattern）"></a>桥接模式（Bridge Design Pattern）</h2><p>对于桥接模式的两种不同的理解：在GOF的《设计模式》中，定义为：”将抽象和实现解耦，让它们可以独立变化”，在其他资料书中，定义为：一个类存在两个（或多个）独立变化的维度，我们通过组合的方式，让这两个（或多个）维度可以独立进行拓展</p>
<p>对于第一种GOF的定义，理解其中的”抽象”和”实现”两个概念，是理解它们的关键。这里的抽象指的并不是抽象类或者接口，而是被抽象出来的一套”类库”，只包含骨架代码，真正的业务逻辑需要委派给定义中的”实现”来完成。而这里的实现，也并非”接口的实现类”，而是一套独立的类库，抽象和实现独立开发，通过对象之间的组合关系，组装在一起</p>
<p>对于第二种理解方式，类似于”组合优于继承”的设计原则，通过组合关系来替代继承关系，避免继承层次过多。</p>
<p>桥接模式的应用，在JDBC中，针对不同的数据库有不同的Driver类，可以按需切换，JDBC只定义接口，具体的实现委托给具体的数据库Driver</p>
<p>下面以不同线上系统不同紧急程度下消息发送的小例子来展示桥接模式</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//消息发送接口类</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">MsgSender</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">send</span><span class="params">(String message)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TelephoneMsgSender</span> <span class="keyword">implements</span> <span class="title">MsgSender</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; telephones;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TelephoneMsgSender</span><span class="params">(List&lt;String&gt; telephones)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.telephones = telephones;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">send</span><span class="params">(String message)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//具体的发送短信的逻辑</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EmailMsgSender</span> <span class="keyword">implements</span> <span class="title">MsgSender</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">send</span><span class="params">(String message)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//类似于TelephoneMsgSender</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WechatMsgSender</span> <span class="keyword">implements</span> <span class="title">MsgSender</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">send</span><span class="params">(String message)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//类似于TelephoneMsgSender</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Notification相当于抽象，MsgSender相当于实现，</span></span><br><span class="line"><span class="comment"> * 两者可以独立开发，通过组合关系（也就是桥梁）任意组合在一起。所谓的任意组合</span></span><br><span class="line"><span class="comment"> * 的意思就是，不同紧急程度的消息和发送渠道之间的对应关系，不是在代码中固定写死，</span></span><br><span class="line"><span class="comment"> * 我们可以动态地去指定（比如通过读取配置来获取对应关系）</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Notification</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> MsgSender msgSender;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Notification</span><span class="params">(MsgSender msgSender)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.msgSender = msgSender;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">notify</span><span class="params">(String message)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *严重情况下消息发送类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SevereNotification</span> <span class="keyword">extends</span> <span class="title">Notification</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SevereNotification</span><span class="params">(MsgSender msgSender)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(msgSender);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">notify</span><span class="params">(String message)</span> </span>&#123;</span><br><span class="line">        msgSender.send(message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">紧急情况下消息发送类（逻辑类似SevereNotification）</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UrgencyNotification</span> <span class="keyword">extends</span> <span class="title">Notification</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">UrgencyNotification</span><span class="params">(MsgSender msgSender)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(msgSender);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">notify</span><span class="params">(String message)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">普通情况下消息发送类（逻辑类似SevereNotification）</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NormalNotification</span> <span class="keyword">extends</span> <span class="title">Notification</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">NormalNotification</span><span class="params">(MsgSender msgSender)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(msgSender);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">notify</span><span class="params">(String message)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="装饰器模式"><a href="#装饰器模式" class="headerlink" title="装饰器模式"></a>装饰器模式</h2><p>装饰器模式并非简单的利用组合替代继承，它有两个比较特殊的地方：</p>
<ul>
<li><strong>装饰类和原始类继承同样的父类</strong>，这样我们可以对原始类”嵌套”多个装饰器类</li>
<li>装饰类是对功能的增强，这也是装饰器模式应用场景的一个重要特点</li>
</ul>
<p>装饰器模式与代理模式的不同点：</p>
<p>代理类增加的是与原始类没有关系的功能，而装饰类增加的是原始类功能的增强</p>
<p>下面是一个简单示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BaseInterface</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">say</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BaseClass</span> <span class="keyword">implements</span> <span class="title">BaseInterface</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">say</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"我是被装饰者，我要开演唱会"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Decorator</span> <span class="keyword">implements</span> <span class="title">BaseInterface</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> BaseInterface baseInterface;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Decorator</span><span class="params">(BaseInterface baseInterface)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.baseInterface = baseInterface;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">say</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"演唱会前我先好好锻炼身体，记歌词"</span>);</span><br><span class="line">        <span class="keyword">this</span>.baseInterface.say();</span><br><span class="line">        System.out.println(<span class="string">"演唱会后我要好好复盘"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        BaseClass base = <span class="keyword">new</span> BaseClass();</span><br><span class="line">        Decorator decorator = <span class="keyword">new</span> Decorator(base);</span><br><span class="line">        decorator.say();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="适配器模式（Adapter-Design-Pattern）"><a href="#适配器模式（Adapter-Design-Pattern）" class="headerlink" title="适配器模式（Adapter Design Pattern）"></a>适配器模式（Adapter Design Pattern）</h2><p>适配器模式是用来做适配的，它将不兼容的接口转换为可兼容的接口，让原本由于接口不兼容而不能一起工作的类可以一起工作。举个形象的例子，USB转接头就是生活中的一种适配器</p>
<p>适配器模式有两种实现方式：类适配器和对象适配器。其中，类适配器使用继承关系实现，对象适配器使用组合关系来实现。</p>
<p>适配器模式适用场景：</p>
<p>一般来说，适配器模式可以看做一种”补偿模式”，用来补救设计上的缺陷。如果在设计初期，我们就能协调规避接口不兼容的问题，那这种模式就没有应用的机会了。适配器模式适用于以下场景：</p>
<ul>
<li><p>封装有缺陷的接口设计</p>
<p>假设我们依赖的外部系统在接口设计方面有缺陷，引入之后会影响到我们自身代码的可测试性。为了隔离设计上的缺陷，我们希望对外部系统提供的接口进行二次封装，抽象出更好的接口设计，这个时候就可以使用适配器模式了。</p>
</li>
<li><p>统一多个类的接口设计</p>
<p>某个功能的实现依赖多个外部系统（或者说类），通过适配器模式，将它们的接口适配为统一的接口定义，然后我们就可以使用多态的特性来复用代码逻辑</p>
</li>
<li><p>替换依赖的外部系统</p>
<p>当我们把项目中依赖的一个外部系统替换为另一个外部系统的时候，依靠适配器模式，可以减少对代码的改动</p>
</li>
<li><p>兼容老版本接口</p>
<p>在做版本升级的时候，对于一些要废弃的接口，我们不直接将其删除，而是暂时保留，并且标注为deprecated，并将内部实现逻辑委托为新的接口实现。这样做的好处是，使用它的项目有个过渡期，而不是强制进行代码修改</p>
</li>
<li><p>适配不同格式的数据</p>
</li>
</ul>
<p>下面是适配器模式的简单示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 需要将其他类适配成该目标类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ITarget</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">f1</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">f2</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">fc</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 源类，需要将该类适配成ITarget接口类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Adaptee</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fa</span><span class="params">()</span></span>&#123;&#125;;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fb</span><span class="params">()</span></span>&#123;&#125;;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fc</span><span class="params">()</span></span>&#123;&#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 类适配器，基于继承</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClassAdaptor</span> <span class="keyword">extends</span> <span class="title">Adaptee</span> <span class="keyword">implements</span> <span class="title">ITarget</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">f1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.fa();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">f2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//重新实现f2</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//这里的fc不需要实现，直接继承自Adaptee，这是和对象适配器最大的不同</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *对象适配器基于组合</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">InstanceAdaptor</span> <span class="keyword">implements</span> <span class="title">ITarget</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Adaptee adaptee;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">InstanceAdaptor</span><span class="params">(Adaptee adaptee)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.adaptee = adaptee;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">f1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        adaptee.fa();<span class="comment">//委托给Adaptee</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">f2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//重新实现f2</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fc</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        adaptee.fc();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="代理、桥接、装饰器、适配器四种设计模式的区别"><a href="#代理、桥接、装饰器、适配器四种设计模式的区别" class="headerlink" title="代理、桥接、装饰器、适配器四种设计模式的区别"></a>代理、桥接、装饰器、适配器四种设计模式的区别</h3><p>代理，桥接，装饰器，适配器，这四种模式是比较常用的结构型设计模式。它们的代码结构非常相似，笼统来说，都可以成为Wrapper模式，也就是通过Wrapper类二次封装原始类。他们之间的区别如下：</p>
<p><strong>代理模式：</strong>代理模式在不改变原始类接口的条件下，为原始类定义一个代理类，主要目的是控制访问，而非加强功能，这是它跟装饰器模式最大的不同</p>
<p><strong>桥接模式：</strong>桥接模式的目的是将接口部分和实现部分分离，从而让它们可以较为容易、相对独立的加以改变</p>
<p><strong>装饰器模式：</strong>装饰者模式在不改变原始类接口的情况下，对原始类功能进行增强，并且支持多个装饰类的嵌套使用</p>
<p><strong>适配器模式：</strong>适配器模式是一种时候的补救策略。适配器提供跟原始类不同的接口，而代理模式、装饰器模式提供的都是跟原始类相同的接口</p>
<h2 id="门面模式（Facade-Design-Pattern）"><a href="#门面模式（Facade-Design-Pattern）" class="headerlink" title="门面模式（Facade Design Pattern）"></a>门面模式（Facade Design Pattern）</h2><p>门面模式主要用于接口设计方面，GOF的《设计模式》中定义如下：门面模式为子系统提供一组统一的接口，定义一组高层接口让子系统更易用，这里的子系统可以有多种理解方式，既可以是一个完整的系统，也可以是更细粒度的类或者模块，门面模式的应用场景如下：</p>
<ul>
<li><p>解决易用性问题</p>
</li>
<li><p>解决性能问题</p>
</li>
<li><p>解决分布式事务问题</p>
</li>
</ul>
<h2 id="组合模式（Composite-Design-Pattern）"><a href="#组合模式（Composite-Design-Pattern）" class="headerlink" title="组合模式（Composite Design Pattern）"></a>组合模式（Composite Design Pattern）</h2><p>组合模式在GOF的《设计模式》中定义如下：将一组对象组织（Compose）成树形结构，以表示一种”部分-整体”的层次结构，组合让客户端（代指代码的使用者）可以统一单个对象和组合对象的处理逻辑</p>
<h2 id="享元模式（Flyweight-Design-Pattern）"><a href="#享元模式（Flyweight-Design-Pattern）" class="headerlink" title="享元模式（Flyweight Design Pattern）"></a>享元模式（Flyweight Design Pattern）</h2><p>享元，顾名思义就是被共享的单元，享元模式的意图是复用对象，节省内存，前提是享元对象是不可变对象。不可变对象指的是，一旦通过构造函数初始化完成之后，它的状态（对象的成员变量或者属性）就不会再被修改了。所以不可变对象不能暴露任何set()等修改内部状态的方法。</p>
<p>Integer类型的缓冲池中保存的-127-128就是一种享元模式的应用，String中常量池也是一种享元模式</p>
<h1 id="行为型设计模式"><a href="#行为型设计模式" class="headerlink" title="行为型设计模式"></a>行为型设计模式</h1><p>创建型设计模式主要解决”对象的创建”问题，结构型设计模式主要解决”类或对象的组合或组装”问题，行为型设计模式主要解决的就是”类或对象之间的交互”问题。行为型设计模式有11种，包括：观察者模式，模板模式，策略模式，责任链模式，状态模式，迭代器模式，访问者模式，备忘录模式，命令模式，解释器模式，中介模式。实际上设计模式要干的事情就是解耦，创建型模式是将创建和使用代码解耦，结构型模式是将不同功能代码解耦，行为型模式是将不同的行为代码解耦。</p>
<h2 id="观察者模式（Observer-Design-Pattern）"><a href="#观察者模式（Observer-Design-Pattern）" class="headerlink" title="观察者模式（Observer Design Pattern）"></a>观察者模式（Observer Design Pattern）</h2><p>观察者模式也被称为发布订阅模式，在GOF《设计模式》中定义为：在对象之间定义一个一对多的依赖，当一个对象状态改变的时候，所有依赖的对象都会自动收到通知。</p>
<p>一个典型的观察者模式应用是spring中的事件监听和谷歌提供的event bus，这里就不举例子了</p>
<h2 id="模板模式（Template-Method-Design-Pattern）"><a href="#模板模式（Template-Method-Design-Pattern）" class="headerlink" title="模板模式（Template Method Design Pattern）"></a>模板模式（Template Method Design Pattern）</h2><p>模板模式，全称是模板方法设计模式，在GOF《设计模式》一书中定义如下：模板方法模式在一个方法中定义一个算法骨架，并将某些步骤推迟到子类中实现。模板方法模式可以让子类在不改变算法整体结构的情况下，重新定义算法中的某些步骤。下面是模板方法模式的一个示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 定义模板方法的父类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractBaseClass</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testMethod</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//定义模板方法流程（业务逻辑顺序），具体方法由子类实现</span></span><br><span class="line">        method1();</span><br><span class="line">        method2();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">method2</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">method1</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        AbstractBaseClass baseClassA = <span class="keyword">new</span> SubClassA();</span><br><span class="line">        baseClassA.testMethod();</span><br><span class="line">        AbstractBaseClass baseClassB = <span class="keyword">new</span> SubClassB();</span><br><span class="line">        baseClassB.testMethod();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SubClassA</span> <span class="keyword">extends</span> <span class="title">AbstractBaseClass</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">method2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"我是子类A的方法二"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">method1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"我是子类A的方法一"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SubClassB</span> <span class="keyword">extends</span> <span class="title">AbstractBaseClass</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">method2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"我是子类B的方法二"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">method1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"我是子类B的方法一"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="模板方法模式的作用"><a href="#模板方法模式的作用" class="headerlink" title="模板方法模式的作用"></a>模板方法模式的作用</h3><ul>
<li><p>复用</p>
<p>模板方法模式把业务逻辑中不变的流程抽象到父类的模板方法中，将可变的部分留给子类实现，所有的子类都可以复用父类中的模板方法定义的流程代码。</p>
</li>
<li><p>扩展</p>
<p>这里说的扩展，并非代码的扩展性，而是指框架的扩展性。模板模式常用在框架的开发中，让框架用户可以在不修改框架源码的情况下，定制化框架的功能。</p>
</li>
</ul>
<p>模板模式和回调的区别：模板模式基于继承来实现，回调基于组合来实现</p>
<h2 id="策略模式（Strategy-Design-Pattern）"><a href="#策略模式（Strategy-Design-Pattern）" class="headerlink" title="策略模式（Strategy Design Pattern）"></a>策略模式（Strategy Design Pattern）</h2><p>在GOF的《设计模式》一书中，策略模式是这样定义的：定义一族算法类，将每个算法分别封装起来，让它们可以相互替换。策略你是可以使算法的变化独立于使用它们的客户端（这里的客户端代指使用算法的代码）</p>
<p>下面是策略模式的一个小例子：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BaseStrategy</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">handle</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StrategyA</span> <span class="keyword">implements</span> <span class="title">BaseStrategy</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"现在执行策略A的代码"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StrategyB</span> <span class="keyword">implements</span> <span class="title">BaseStrategy</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"现在执行策略B的代码"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StrategyC</span> <span class="keyword">implements</span> <span class="title">BaseStrategy</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"现在执行策略C的代码"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> StrategyTypeEnums &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 策略枚举类</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    STRATEGYA(<span class="string">"A"</span>,<span class="keyword">new</span> StrategyA()),</span><br><span class="line">    STRATEGYB(<span class="string">"B"</span>,<span class="keyword">new</span> StrategyB()),</span><br><span class="line">    STRATEGYC(<span class="string">"C"</span>,<span class="keyword">new</span> StrategyC()),</span><br><span class="line">    ;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String type;</span><br><span class="line">    <span class="keyword">private</span> BaseStrategy baseStrategy;</span><br><span class="line"></span><br><span class="line">    StrategyTypeEnums(String type, BaseStrategy baseStrategy) &#123;</span><br><span class="line">        <span class="keyword">this</span>.type = type;</span><br><span class="line">        <span class="keyword">this</span>.baseStrategy = baseStrategy;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> BaseStrategy <span class="title">getStrategyByType</span><span class="params">(String type)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (type == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (StrategyTypeEnums value : values()) &#123;</span><br><span class="line">            <span class="keyword">if</span> (value.type.equals(type))&#123;</span><br><span class="line">                <span class="keyword">return</span> value.baseStrategy;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//客户端</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StrategyClient</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String type = <span class="string">"A"</span>;</span><br><span class="line">        BaseStrategy strategyByType = StrategyTypeEnums.getStrategyByType(type);</span><br><span class="line">        <span class="keyword">if</span> (strategyByType != <span class="keyword">null</span>) &#123;</span><br><span class="line">            strategyByType.handle();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="责任链模式（Chain-of-Responsibility-Design-Pattern）"><a href="#责任链模式（Chain-of-Responsibility-Design-Pattern）" class="headerlink" title="责任链模式（Chain of Responsibility Design Pattern）"></a>责任链模式（Chain of Responsibility Design Pattern）</h2><p>责任链模式在GOF的《设计模式》中定义为：将请求的发送和接收解耦，让多个接收对象都有机会处理这个请求。将这些接受对象串成一条链，并沿着这条链传递这个请求，直到链上的某个接受对象能够处理它为止。</p>
<p>下面是责任链模式的一个小例子：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BaseHandler</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">handle</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FirstHandler</span> <span class="keyword">implements</span> <span class="title">BaseHandler</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"经过第一个处理器"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SecondHandler</span> <span class="keyword">implements</span> <span class="title">BaseHandler</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"经过第二个处理器"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThirdHandler</span> <span class="keyword">implements</span> <span class="title">BaseHandler</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"经过第三个处理器"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BaseConfig</span> <span class="keyword">implements</span> <span class="title">InitializingBean</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> List&lt;BaseHandler&gt; handlers = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">   <span class="meta">@Autowired</span></span><br><span class="line">   <span class="keyword">private</span> FirstHandler firstHandler;</span><br><span class="line">   <span class="meta">@Autowired</span></span><br><span class="line">   <span class="keyword">private</span> SecondHandler secondHandler;</span><br><span class="line">   <span class="meta">@Autowired</span></span><br><span class="line">   <span class="keyword">private</span> ThirdHandler thirdHandler;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterPropertiesSet</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"开始加入配置"</span>);</span><br><span class="line">        handlers.add(firstHandler);</span><br><span class="line">        handlers.add(secondHandler);</span><br><span class="line">        handlers.add(thirdHandler);</span><br><span class="line">        System.out.println(<span class="string">"配置加入完毕"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/design"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DesignPatternClient</span> </span>&#123;</span><br><span class="line">    <span class="comment">//两种方式都可以拿到责任链中的处理器</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="comment">//private List&lt;BaseHandler&gt; baseHandlers = BaseConfig.handlers;</span></span><br><span class="line">    Map&lt;String,BaseHandler&gt; map;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/testHandler"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testHandler</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">/*baseHandlers.forEach(h-&gt;&#123;</span></span><br><span class="line"><span class="comment">            h.handle();</span></span><br><span class="line"><span class="comment">        &#125;);*/</span></span><br><span class="line">        <span class="keyword">for</span>(Map.Entry&lt;String, BaseHandler&gt; entry :map.entrySet())&#123;</span><br><span class="line">            entry.getValue().handle();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="状态模式"><a href="#状态模式" class="headerlink" title="状态模式"></a>状态模式</h2><p>状态模式一般用来实现有限状态机（Finite State Machine），缩写为FSM。状态机有三个组成部分：状态（state）、事件（event）、动作（Action），其中事件也称为转移条件，事件触发状态的转移及动作的执行。例如订单的状态可以会有各种不同的流转，通过状态模式可以将不同状态可以进行的动作拆分开来。</p>
<p>状态模式比较简单，此处不再举例。</p>
<h2 id="备忘录模式（Memento-Design-Pattern）"><a href="#备忘录模式（Memento-Design-Pattern）" class="headerlink" title="备忘录模式（Memento Design Pattern）"></a>备忘录模式（Memento Design Pattern）</h2><p>在GOF的《设计模式》一书中，备忘录模式的定义为：在不违背封装原则的前提下，捕获一个对象的内部状态，并在该对象之外保存这个状态，以便之后恢复对象为先前的状态。</p>
<h2 id="迭代器模式（Iterator-Design-Pattern）"><a href="#迭代器模式（Iterator-Design-Pattern）" class="headerlink" title="迭代器模式（Iterator Design Pattern）"></a>迭代器模式（Iterator Design Pattern）</h2><p>迭代器模式也叫游标模式，是用来遍历集合对象的。相比于for循环，迭代器模式有如下优点：</p>
<ul>
<li>迭代器模式封装集合内容部的复杂数据结构，开发者不需要了解如何遍历，直接使用容器提供的迭代器即可</li>
<li>迭代器模式将集合对象的遍历操作从集合类中拆分出来，放到迭代器类中，让两者的职责更加单一</li>
<li>迭代器模式让添加新的遍历算法更加容易，更符合开闭原则。此外，迭代器都实现自相同的接口，在开发中，基于接口而非实现编程，替换迭代器也变得更加容易。</li>
</ul>
<h2 id="访问者模式（Visitor-Design-Pattern）"><a href="#访问者模式（Visitor-Design-Pattern）" class="headerlink" title="访问者模式（Visitor Design Pattern）"></a>访问者模式（Visitor Design Pattern）</h2><p>在GOF的《设计模式》一书中，访问者模式的定义为：允许一个或多个操作应用到一组对象上，解耦操作和对象本身。</p>
<h2 id="命令模式（Command-Design-Pattern）"><a href="#命令模式（Command-Design-Pattern）" class="headerlink" title="命令模式（Command Design Pattern）"></a>命令模式（Command Design Pattern）</h2><p>在GOF的《设计模式》一书中，命令模式的定义为：将请求（命令）封装为一个对象，这样可以使用不同的请求参数化对象（将不同请求依赖注入到其他对象），并且能够支持请求（命令）的排队执行、记录日志、撤销等（附加控制）功能。</p>
<h2 id="解释器模式（Interpreter-Design-Pattern）"><a href="#解释器模式（Interpreter-Design-Pattern）" class="headerlink" title="解释器模式（Interpreter Design Pattern）"></a>解释器模式（Interpreter Design Pattern）</h2><p>在GOF的《设计模式》一书中，解释器模式的定义为：解释器模式为某个语言定义它的语法（或叫文法）表示，并定义一个解释器用来处理这个语法。</p>
<p>spel表达式类似解释器模式，规则引擎类似解释器模式。</p>
<h2 id="中介模式（Mediator-Design-Pattern）"><a href="#中介模式（Mediator-Design-Pattern）" class="headerlink" title="中介模式（Mediator Design Pattern）"></a>中介模式（Mediator Design Pattern）</h2><p>在GOF的《设计模式》一书中，中介模式的定义为：中介模式定义了一个单独的（中介）对象，来封装一组对象之间的交互。将这组对象之间的交互委派给与中介对象，来避免对象之间的直接交互。</p>
<p>中介模式的设计思想与中间层很像，通过引入中介这个中间层，将一组对象之间的交互关系（或者依赖关系）从多对多(网状关系)转换为一对多（星状关系）。原来一个对象要跟n个对象交互，从而最小化对象之间的交互关系，降低了代码的复杂度，提高了代码的可读性和可维护性。</p>
<p>观察者模式和中介模式都是为了实现参与者之间的解耦，简化交互关系。两者的不同在于应用场景上。在观察者模式的应用场景中，参与者之间的交互比较有条理，一般都是单向的，一个参与者只有一个身份，要么是观察者，要么是被观察者。而在中介模式的引用场景中，参与者之间的关系错综复杂，既可以是消息的发送者，也可以同时是消息的接收者。</p>

        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    最后更新时间：<time datetime="2020-07-28T11:34:30.000Z" itemprop="dateUpdated">2020-07-28 19:34:30</time>
</span><br>


        
        每天一点成长，一点收获
        
    </div>
    
    <footer>
        <a href="https://www.enjoyican.com">
            <img src="/img/head.jpg" alt="enjoycodingfun">
            enjoycodingfun
        </a>
    </footer>
</blockquote>

        
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>



        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/note/" rel="tag">note</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://www.enjoyican.com/posts/the-beauty-of-design-pattern-two/&title=《设计模式之美学习笔记二》 — Running&pic=https://www.enjoyican.com/img/head.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://www.enjoyican.com/posts/the-beauty-of-design-pattern-two/&title=《设计模式之美学习笔记二》 — Running&source=这部分总结了23种设计模式的定义，适用场景，部分设计模式写了小demo来演示。总体来说设计模式一定要注意他的适用场景和实现方式这两点，只关注实现方式，就会..." data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://www.enjoyican.com/posts/the-beauty-of-design-pattern-two/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《设计模式之美学习笔记二》 — Running&url=https://www.enjoyican.com/posts/the-beauty-of-design-pattern-two/&via=https://www.enjoyican.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://www.enjoyican.com/posts/the-beauty-of-design-pattern-two/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between flex-row-reverse">
  

  
    <div class="waves-block waves-effect next">
      <a href="/posts/the-beauty-of-design-pattern-one/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">设计模式之美学习笔记一</h4>
      </a>
    </div>
  
</nav>



    











    <!-- Valine Comments -->
    <div class="comments vcomment" id="comments"></div>
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src="//unpkg.com/valine@latest/dist/Valine.min.js"></script>
    <!-- Valine Comments script -->
    <script>
        var GUEST_INFO = ['nick','mail','link'];
        var guest_info = 'nick,mail,link'.split(',').filter(function(item){
          return GUEST_INFO.indexOf(item) > -1
        });
        new Valine({
            el: '#comments',
            notify: 'true' == 'true',
            verify: 'false' == 'true',
            appId: "ulrMiFi5yrRdTGP8FEHMehcm-gzGzoHsz",
            appKey: "JjlHLHV0knhiDfaMJgjSgdYz",
            avatar: "mm",
            placeholder: "写点什么吧(*￣︶￣)",
            guest_info: guest_info.length == 0 ? GUEST_INFO : guest_info,
            pageSize: "10"
        })
    </script>
    <!-- Valine Comments end -->










</article>

<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        谢谢关注~
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/img/wechatpay.jpg" alt="打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <input id="rewardToggle" type="checkbox" class="reward-toggle-check"
                data-wechat="/img/wechatpay.jpg" data-alipay="/img/alipay.jpg">
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-label"></span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>博客内容遵循 <a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">CC BY-NC-SA 4.0</a>协议 转载请注明出处</span>
        </p>
    </div>
    <div class="bottom">
        <p><span>enjoycodingfun &copy; 2015 - 2020</span>
            <span>
                
                <a href="http://www.beian.miit.gov.cn" target="_blank">浙ICP备20006880号-1</a><br>
                
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://www.enjoyican.com/posts/the-beauty-of-design-pattern-two/&title=《设计模式之美学习笔记二》 — Running&pic=https://www.enjoyican.com/img/head.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://www.enjoyican.com/posts/the-beauty-of-design-pattern-two/&title=《设计模式之美学习笔记二》 — Running&source=这部分总结了23种设计模式的定义，适用场景，部分设计模式写了小demo来演示。总体来说设计模式一定要注意他的适用场景和实现方式这两点，只关注实现方式，就会..." data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://www.enjoyican.com/posts/the-beauty-of-design-pattern-two/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《设计模式之美学习笔记二》 — Running&url=https://www.enjoyican.com/posts/the-beauty-of-design-pattern-two/&via=https://www.enjoyican.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://www.enjoyican.com/posts/the-beauty-of-design-pattern-two/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACuklEQVR42u3aQW4bQQwEQP//0w4Q5GAgkNRNzkg+1J4Wlr1izWFJk/z6iq/vv9fP+/Ynj57z/33y+4cvPDw8vFHoj64krBaWhJvE8DxmPDw8vNu8NhnkB/T8yJ4Hlxz3CwseHh7eR3ltBZsc1vODS5IEHh4e3m/mnWo3nH0yHh4e3qd4efmbF9x5a+N52nhTrwUPDw8v5s0GYJ+9vz7fw8PDwxtN1fMWav6ablPOLM5/T8DDw8O7wGuH+vlCQFtw52O2trGLh4eH937ebKB1drFg07bAw8PDu8HLh0z5p3naSALdHAEeHh7eWd7+oZslgGRktTkOPDw8vBu8vDhO2gRJ0LOB1mqyh4eHh3eBN1vAakvtYRM2RkZHgIeHh3eUl7Rik2J3Fm5yv2mL4OHh4Z3izUZfs7WDTd07W0HAw8PDu8dbPaJsRuTPPFAb4+Hh4V3jtW2IdjCWFOWnFrCK/jQeHh7emU5pEeJm/D871jZaPDw8vHu8vIxuW6uzVYMEmXyKh4eHd4O3KZfzEnmWJPI28cNvxMPDw7vGy0dcbUOhDahtKL9IJ3h4eHgXeO1rvX1Zt42D/THh4eHh3eZtGqz7IVm7gFXXyXh4eHgXeEnRnHx98uI+tcyafy8eHh7eDV7+z/9mVWuzepUM3uqdMjw8PLyjvFkLtX2V50VzUlIXiQEPDw9vzWur71ljN28lJCmhTUV4eHh4Z3l5syBp+LYl+L5dG+U9PDw8vGu82YgrTxjtc/K1qoeR4OHh4V3gnWoltOVyi5zd4+Hh4d3j5cmgXRFok01e1udtXzw8PLx7vP1LPx+VtS2JPHW9WCDAw8PDeztvP9BKFqdm8eDh4eH9Zt4mhbRrB+1frUpqPDw8vJKXD73ahsIsqUSNhiS14OHh4V3gta/vfEGqXcZqW7ermR4eHh7ehPcHke1pzkUlGvEAAAAASUVORK5CYII=" alt="微信分享二维码">
</div>




<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?b9131a5ca31e54205078b286dad06616";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

<script>
  (function () {
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js'
    } else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js'
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s)
  })();
</script>

    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: true };


</script>

<script src="/js/main.min.js?v=1.7.2"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="/js/search.min.js?v=1.7.2" async></script>






<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = '欢迎再来！';
            clearTimeout(titleTime);
        } else {
            document.title = '悦码小站';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
